import{k as z,c as V,a as q,l as J,A as M,r as o,b as u,u as w,j as i,m as Q,d as j,s as K,T as Y,e as C,n as X,o as ee,H as te,I,V as R,F as se,p as ae,h as re,P as ce}from"./index-B5sKGF0T.js";import{D as oe}from"./DynamicModuleLoader-CRhxfWmK.js";import{A as P,a as x,b as S,c as ne,I as ie,S as le}from"./StickyContentLayout-Bajp4WFw.js";import{T as k,C as E}from"./Avatar-CS1FaJc3.js";import{l as de,D as ge,M as Ce}from"./Drawer-VE2znHAb.js";import{L as T}from"./ListBox-CsHUvXk9.js";import{T as me}from"./Text-SEN0pMjy.js";import{I as ue}from"./Input-C1-90urI.js";function H({off:t,on:e,name:a}){return z(a)?e():t()}function he(t){const e=new URLSearchParams(window.location.search);return Object.entries(t).forEach(([a,r])=>{r!==void 0&&e.set(a,r)}),`?${e.toString()}`}function pe(t){window.history.pushState(null,"",he(t))}const F=t=>{var e;return((e=t.articlesPage)==null?void 0:e.isLoading)||!1},Se=t=>{var e;return(e=t.articlesPage)==null?void 0:e.error},O=t=>{var e;return((e=t.articlesPage)==null?void 0:e.view)||P.SMALL},Z=t=>{var e;return((e=t.articlesPage)==null?void 0:e.page)||1},Ae=t=>{var e;return((e=t.articlesPage)==null?void 0:e.limit)||9},ve=t=>{var e;return(e=t.articlesPage)==null?void 0:e.hasMore},we=t=>{var e;return(e=t.articlesPage)==null?void 0:e._inited},B=t=>{var e;return((e=t.articlesPage)==null?void 0:e.order)??"asc"},D=t=>{var e;return((e=t.articlesPage)==null?void 0:e.sort)??x.CREATED},$=t=>{var e;return((e=t.articlesPage)==null?void 0:e.search)??""},U=t=>{var e;return((e=t.articlesPage)==null?void 0:e.type)??S.ALL},v=V("articlesPage/fetchArticlesList",async(t,e)=>{const{extra:a,rejectWithValue:r,getState:n}=e,s=Ae(n()),c=D(n()),l=B(n()),d=$(n()),h=Z(n()),p=U(n());try{pe({sort:c,order:l,search:d,type:p});const f=await a.api.get("/articles",{params:{_expand:"user",_limit:s,_page:h,_sort:c,_order:l,q:d,type:p===S.ALL?void 0:p}});if(!f.data)throw new Error;return f.data}catch{return r("error")}}),A=J({selectId:t=>t.id}),fe=A.getSelectors(t=>t.articlesPage||A.getInitialState()),xe=q({name:"articlesPageSlice",initialState:A.getInitialState({isLoading:!1,error:void 0,ids:[],entities:{},view:P.SMALL,page:1,hasMore:!0,_inited:!1,limit:9,sort:x.CREATED,search:"",order:"asc",type:S.ALL}),reducers:{setView:(t,e)=>{t.view=e.payload,localStorage.setItem(M,e.payload)},setPage:(t,e)=>{t.page=e.payload},setOrder:(t,e)=>{t.order=e.payload},setSort:(t,e)=>{t.sort=e.payload},setType:(t,e)=>{t.type=e.payload},setSearch:(t,e)=>{t.search=e.payload},initState:t=>{const e=localStorage.getItem(M);t.view=e,t.limit=e===P.BIG?4:9,t._inited=!0}},extraReducers:t=>{t.addCase(v.pending,(e,a)=>{e.error=void 0,e.isLoading=!0,a.meta.arg.replace&&A.removeAll(e)}).addCase(v.fulfilled,(e,a)=>{e.isLoading=!1,e.hasMore=a.payload.length>=e.limit,a.meta.arg.replace?A.setAll(e,a.payload):A.addMany(e,a.payload)}).addCase(v.rejected,(e,a)=>{e.isLoading=!1,e.error=a.payload})}}),{reducer:Pe,actions:g}=xe,Le=o.memo(t=>{const{className:e}=t,a=u(fe.selectAll),r=u(F),n=u(O),s=u(Se),{t:c}=w();return s?i.jsx(k,{text:c("Ошибка при загрузке статей")}):i.jsx(ne,{isLoading:r,view:n,articles:a,className:e})}),ye=V("articlesPage/fetchNextArticlesPage",async(t,e)=>{const{getState:a,dispatch:r}=e,n=ve(a()),s=Z(a()),c=F(a());n&&!c&&(r(g.setPage(s+1)),r(v({})))}),Ve=V("articlesPage/initArticlesPage",async(t,e)=>{const{getState:a,dispatch:r}=e;if(!we(a())){const s=t.get("order"),c=t.get("sort"),l=t.get("search"),d=t.get("type");s&&r(g.setOrder(s)),c&&r(g.setSort(c)),l&&r(g.setSearch(l)),d&&r(g.setType(d)),r(g.initState()),r(v({}))}}),je="_list_cxwpv_4",_={list:je},Ee=o.memo(()=>{const{t}=w(),[e,a]=o.useState(!1),{isArticlesPageWasOpened:r}=Q(),n=j();o.useEffect(()=>{r||(a(!0),n(K({isArticlesPageWasOpened:!0})))},[n,r]);const s=()=>a(!1),c=i.jsx(k,{title:t("Добро пожаловать на страницу статей"),text:t("Здесь вы можете искать и просматривать статьи на различные темы")});return de.isMobile?i.jsx(ge,{lazy:!0,isOpen:e,onClose:s,children:c}):i.jsx(Ce,{lazy:!0,isOpen:e,onClose:s,children:c})}),Me=t=>o.createElement("svg",{width:"1em",height:"1em",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",...t},o.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M3.75 18C3.75 17.8011 3.82902 17.6103 3.96967 17.4697C4.11032 17.329 4.30109 17.25 4.5 17.25H19.5C19.6989 17.25 19.8897 17.329 20.0303 17.4697C20.171 17.6103 20.25 17.8011 20.25 18C20.25 18.1989 20.171 18.3897 20.0303 18.5303C19.8897 18.671 19.6989 18.75 19.5 18.75H4.5C4.30109 18.75 4.11032 18.671 3.96967 18.5303C3.82902 18.3897 3.75 18.1989 3.75 18ZM3.75 12C3.75 11.8011 3.82902 11.6103 3.96967 11.4697C4.11032 11.329 4.30109 11.25 4.5 11.25H19.5C19.6989 11.25 19.8897 11.329 20.0303 11.4697C20.171 11.6103 20.25 11.8011 20.25 12C20.25 12.1989 20.171 12.3897 20.0303 12.5303C19.8897 12.671 19.6989 12.75 19.5 12.75H4.5C4.30109 12.75 4.11032 12.671 3.96967 12.5303C3.82902 12.3897 3.75 12.1989 3.75 12ZM3.75 6C3.75 5.80109 3.82902 5.61032 3.96967 5.46967C4.11032 5.32902 4.30109 5.25 4.5 5.25H19.5C19.6989 5.25 19.8897 5.32902 20.0303 5.46967C20.171 5.61032 20.25 5.80109 20.25 6C20.25 6.19891 20.171 6.38968 20.0303 6.53033C19.8897 6.67098 19.6989 6.75 19.5 6.75H4.5C4.30109 6.75 4.11032 6.67098 3.96967 6.53033C3.82902 6.38968 3.75 6.19891 3.75 6V6Z"})),Te=t=>o.createElement("svg",{width:"1em",height:"1em",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",...t},o.createElement("path",{d:"M6 4H18C18.5304 4 19.0391 4.21071 19.4142 4.58579C19.7893 4.96086 20 5.46957 20 6V18C20 18.5304 19.7893 19.0391 19.4142 19.4142C19.0391 19.7893 18.5304 20 18 20H6C5.46957 20 4.96086 19.7893 4.58579 19.4142C4.21071 19.0391 4 18.5304 4 18V6C4 5.46957 4.21071 4.96086 4.58579 4.58579C4.96086 4.21071 5.46957 4 6 4V4ZM13 13V18H18V13H13ZM6 13V18H11V13H6ZM13 6V11H18V6H13ZM6 6V11H11V6H6Z"})),He=t=>o.createElement("svg",{width:"1em",height:"1em",viewBox:"0 0 32 32",xmlns:"http://www.w3.org/2000/svg",...t},o.createElement("path",{d:"M8.28572 8C7.57564 8 7 8.51168 7 9.14286C7 9.77404 7.57564 10.2857 8.28572 10.2857H23.7143C24.4244 10.2857 25 9.77404 25 9.14286C25 8.51167 24.4244 8 23.7143 8H8.28572Z",fill:"currentColor"}),o.createElement("path",{d:"M8.28572 17.1429C7.57564 17.1429 7 16.6312 7 16C7 15.3688 7.57563 14.8571 8.28571 14.8571H23.7143C24.4244 14.8571 25 15.3688 25 16C25 16.6312 24.4244 17.1429 23.7143 17.1429H8.28572Z",fill:"currentColor"}),o.createElement("path",{d:"M8.28572 24C7.57564 24 7 23.4883 7 22.8571C7 22.226 7.57563 21.7143 8.28571 21.7143H23.7143C24.4244 21.7143 25 22.226 25 22.8571C25 23.4883 24.4244 24 23.7143 24H8.28572Z",fill:"currentColor"})),_e=t=>o.createElement("svg",{width:"1em",height:"1em",viewBox:"0 0 32 32",xmlns:"http://www.w3.org/2000/svg",...t},o.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7 23.7143V8.28571C7 7.57563 7.57563 7 8.28571 7H23.7143C24.4244 7 25 7.57563 25 8.28571V23.7143C25 24.4244 24.4244 25 23.7143 25H8.28571C7.57563 25 7 24.4244 7 23.7143ZM17.2857 10.0714C17.2857 9.79529 17.5096 9.57143 17.7857 9.57143H21.9286C22.2047 9.57143 22.4286 9.79529 22.4286 10.0714V14.2143C22.4286 14.4904 22.2047 14.7143 21.9286 14.7143H17.7857C17.5096 14.7143 17.2857 14.4904 17.2857 14.2143V10.0714ZM17.2857 17.7857C17.2857 17.5096 17.5096 17.2857 17.7857 17.2857H21.9286C22.2047 17.2857 22.4286 17.5096 22.4286 17.7857V21.9286C22.4286 22.2047 22.2047 22.4286 21.9286 22.4286H17.7857C17.5096 22.4286 17.2857 22.2047 17.2857 21.9286V17.7857ZM14.7143 10.0714C14.7143 9.79529 14.4904 9.57143 14.2143 9.57143H10.0714C9.79529 9.57143 9.57143 9.79529 9.57143 10.0714V14.2143C9.57143 14.4904 9.79529 14.7143 10.0714 14.7143L14.2143 14.7143C14.4904 14.7143 14.7143 14.4904 14.7143 14.2143V10.0714ZM14.7143 21.9286C14.7143 22.2047 14.4904 22.4286 14.2143 22.4286L10.0714 22.4286C9.79529 22.4286 9.57143 22.2047 9.57143 21.9286V17.7857C9.57143 17.5096 9.79529 17.2857 10.0714 17.2857L14.2143 17.2857C14.4904 17.2857 14.7143 17.5096 14.7143 17.7857V21.9286Z",fill:"currentColor"})),be="_ArticleViewSelector_ynv1a_1",Ne="_notSelected_ynv1a_1",Ie="_ArticleViewSelectorRedesigned_ynv1a_5",L={ArticleViewSelector:be,notSelected:Ne,ArticleViewSelectorRedesigned:Ie},b=[{view:P.SMALL,icon:H({name:"isAppRedesigned",on:()=>_e,off:()=>Te})},{view:P.BIG,icon:H({name:"isAppRedesigned",on:()=>He,off:()=>Me})}],Re=o.memo(t=>{const{className:e,view:a,onViewClick:r}=t,n=s=>()=>{r==null||r(s)};return i.jsx(Y,{feature:"isAppRedesigned",on:i.jsx(E,{className:C(L.ArticleViewSelectorRedesigned,{},[e]),border:"round",children:i.jsx(te,{gap:"8",children:b.map(s=>i.jsx(I,{clickable:!0,onClick:n(s.view),Svg:s.icon,className:C("",{[L.notSelected]:s.view!==a})},s.view))})}),off:i.jsx("div",{className:C(L.ArticleViewSelector,{},[e]),children:b.map(s=>i.jsx(X,{theme:ee.CLEAR,onClick:n(s.view),children:i.jsx(ie,{width:24,height:24,Svg:s.icon,className:C("",{[L.notSelected]:s.view!==a})})},s.view))})})});function ke(t,e){const a=o.useRef();return o.useCallback((...r)=>{a.current&&clearTimeout(a.current),a.current=setTimeout(()=>{t(...r)},e)},[t,e])}function W(){const t=u(O),e=u(D),a=u(B),r=u($),n=u(U),s=j(),c=o.useCallback(()=>{s(v({replace:!0}))},[s]),l=ke(c,500),d=o.useCallback(m=>{s(g.setView(m))},[s]),h=o.useCallback(m=>{s(g.setSort(m)),s(g.setPage(1)),c()},[s,c]),p=o.useCallback(m=>{s(g.setOrder(m)),s(g.setPage(1)),c()},[s,c]),f=o.useCallback(m=>{s(g.setSearch(m)),s(g.setPage(1)),l()},[s,l]),G=o.useCallback(m=>{s(g.setType(m)),s(g.setPage(1)),c()},[s,c]);return{view:t,sort:e,order:a,search:r,type:n,onChangeView:d,onChangeSort:h,onChangeOrder:p,onChangeSearch:f,onChangeType:G}}const Fe=o.memo(t=>{const{className:e}=t,{view:a,onChangeView:r}=W();return i.jsx(Re,{className:e,view:a,onViewClick:r})}),Oe="_ArticlesFilters_kqgr1_1",N={ArticlesFilters:Oe},Ze={},Be=o.memo(t=>{const{className:e,onChangeOrder:a,onChangeSort:r,order:n,sort:s}=t,{t:c}=w(),l=o.useMemo(()=>[{value:"asc",content:c("возрастанию")},{value:"desc",content:c("убыванию")}],[c]),d=o.useMemo(()=>[{value:x.CREATED,content:c("дате создания")},{value:x.TITLE,content:c("названию")},{value:x.VIEWS,content:c("просмотрам")}],[c]);return i.jsx("div",{className:C(Ze.ArticleSortSelectorRedesigned,{},[e]),children:i.jsxs(R,{gap:"8",children:[i.jsx(me,{text:c("Сортировать по:")}),i.jsx(T,{items:d,value:s,onChange:r}),i.jsx(T,{items:l,value:n,onChange:a})]})})}),De="_Tabs_1m41c_1",$e="_selected_1m41c_7",y={Tabs:De,selected:$e},Ue=o.memo(t=>{const{className:e,tabs:a,onTabClick:r,value:n,direction:s="row"}=t,c=o.useCallback(l=>()=>{r(l)},[r]);return i.jsx(se,{direction:s,gap:"8",align:"start",className:C(y.Tabs,{},[e]),children:a.map(l=>{const d=l.value===n;return i.jsx(E,{variant:d?"light":"normal",className:C(y.tab,{[y.selected]:d}),onClick:c(l),border:"round",children:l.content},l.value)})})}),We=o.memo(t=>{const{className:e,value:a,onChangeType:r}=t,{t:n}=w(),s=o.useMemo(()=>[{value:S.ALL,content:n("Все статьи")},{value:S.IT,content:n("Айти")},{value:S.ECONOMICS,content:n("Экономика")},{value:S.SCIENCE,content:n("Наука")}],[n]),c=o.useCallback(l=>{r(l.value)},[r]);return i.jsx(Ue,{direction:"column",tabs:s,value:a,onTabClick:c,className:C("",{},[e])})}),Ge=t=>o.createElement("svg",{width:"1em",height:"1em",viewBox:"0 0 32 32",xmlns:"http://www.w3.org/2000/svg",...t},o.createElement("path",{d:"M18.679 19.739C17.4734 20.6748 15.9564 21.116 14.4369 20.9728C12.9175 20.8296 11.5097 20.1127 10.5002 18.9681C9.49062 17.8234 8.95522 16.3371 9.00294 14.8117C9.05065 13.2862 9.67789 11.8363 10.757 10.757C11.8363 9.67789 13.2862 9.05065 14.8117 9.00294C16.3371 8.95522 17.8234 9.49062 18.9681 10.5002C20.1127 11.5097 20.8296 12.9175 20.9728 14.4369C21.116 15.9564 20.6748 17.4734 19.739 18.679L22.779 21.719C22.8777 21.8107 22.9499 21.9273 22.9879 22.0565C23.0259 22.1858 23.0284 22.3229 22.995 22.4534C22.9616 22.5839 22.8937 22.703 22.7983 22.7982C22.7029 22.8933 22.5836 22.961 22.453 22.994C22.3226 23.0274 22.1856 23.0251 22.0565 22.9872C21.9273 22.9494 21.8107 22.8775 21.719 22.779L18.679 19.739ZM19.499 14.999C19.5079 14.4026 19.3981 13.8104 19.176 13.2568C18.9539 12.7032 18.624 12.1993 18.2054 11.7744C17.7868 11.3496 17.2879 11.0121 16.7377 10.7818C16.1875 10.5515 15.597 10.4329 15.0005 10.4329C14.404 10.4329 13.8135 10.5515 13.2633 10.7818C12.7131 11.0121 12.2142 11.3496 11.7956 11.7744C11.377 12.1993 11.047 12.7032 10.825 13.2568C10.6029 13.8104 10.4931 14.4026 10.502 14.999C10.5196 16.1805 11.0013 17.3076 11.843 18.1368C12.6847 18.9661 13.8189 19.4309 15.0005 19.4309C16.1821 19.4309 17.3162 18.9661 18.158 18.1368C18.9997 17.3076 19.4814 16.1805 19.499 14.999Z",fill:"currentColor"})),ze=o.memo(t=>{const{className:e,onChangeType:a,onChangeSearch:r,search:n,onChangeSort:s,sort:c,onChangeOrder:l,order:d,type:h}=t,{t:p}=w();return i.jsx(E,{className:C(N.ArticlesFilters,{},[e]),padding:"24",children:i.jsxs(R,{gap:"32",children:[i.jsx(ue,{onChange:r,value:n,size:"s",placeholder:p("Поиск"),addonLeft:i.jsx(I,{Svg:Ge})}),i.jsx(We,{value:h,onChangeType:a,className:N.tabs}),i.jsx(Be,{order:d,sort:c,onChangeOrder:l,onChangeSort:s})]})})}),qe=o.memo(t=>{const{className:e}=t,{onChangeSort:a,onChangeType:r,sort:n,type:s,onChangeSearch:c,search:l,onChangeOrder:d,order:h}=W();return i.jsx(ze,{type:s,onChangeSearch:c,order:h,onChangeOrder:d,search:l,sort:n,onChangeSort:a,onChangeType:r,className:e})}),Je={articlesPage:Pe},Qe=t=>{const{className:e}=t,{t:a}=w(),r=j(),[n]=ae(),s=o.useCallback(()=>{r(ye())},[r]);re(()=>{r(Ve(n))});const c=i.jsx(le,{left:i.jsx(Fe,{}),right:i.jsx(qe,{}),content:i.jsxs(ce,{"data-testid":"ArticlesPage",onScrollEnd:s,className:C(_.ArticlesPageRedesigned,{},[e]),children:[i.jsx(Le,{className:_.list}),i.jsx(Ee,{})]})});return i.jsx(oe,{reducers:Je,removeAfterUnmount:!1,children:c})},c1=o.memo(Qe);export{c1 as default};
